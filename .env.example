# =============================================================================
# Plex Discord Control - Environment Configuration
# =============================================================================
# Copy this file to .env and modify values for your deployment
# All values support the default configuration for local development

# =============================================================================
# Network Configuration
# =============================================================================

# Host IP address for the container (used for external connections and nginx)
# This should be the IP address where your TrueNAS/Docker host is accessible
# Default: 192.168.xxx.xxx
CONTAINER_HOST_IP=192.168.xxx.xxx

# =============================================================================
# Discord Bot Configuration
# =============================================================================

# Discord bot token (obtain from Discord Developer Portal)
DISCORD_BOT_TOKEN=your_discord_bot_token_here

# Discord WebSocket server connection details
# This is the external URL that the Discord bot uses to connect
# Format: wss://domain.com/discord or wss://ip:port/discord
# Default: wss://discord.xxx.com/discord
DISCORD_BOT_WS_URL=wss://discord.xxx.com/discord

# =============================================================================
# WebSocket Server Configuration (Inside Container)
# =============================================================================

# Port 10100: Discord Bot connections (WSS - SSL enabled)
# Default: 10100
WS_DISCORD_PORT=10100

# Port 10009: Firefox Extension connections (WS - plain websocket)
# Default: 10009
WS_BROWSER_PORT=10009

# Host to bind WebSocket servers to
# For port 10100 (Discord): Should be 0.0.0.0 to accept external connections
# For port 10009 (Browser): Should be 127.0.0.1 for localhost-only access
# Default: 0.0.0.0 for port 10100, 127.0.0.1 for port 10009
WS_DISCORD_HOST=0.0.0.0
WS_BROWSER_HOST=127.0.0.1

# =============================================================================
# Nginx Proxy Configuration
# =============================================================================

# Port 10101: Nginx WSS proxy (SSL termination)
# Default: 10101
NGINX_WSS_PROXY_PORT=10101

# External domain name for Discord bot connections
# This should match your nginx configuration
# Default: discord.xxx.com
EXTERNAL_DOMAIN=discord.xxx.com

# =============================================================================
# Plex Configuration
# =============================================================================

# Plex server IP/hostname
# Used by Firefox extension to connect to Plex
# Default: 192.168.xxx.xxx
PLEX_SERVER_IP=192.168.xxx.xxx

# Plex server port
# Default: 32400
PLEX_SERVER_PORT=32400

# Plex web interface URLs (used by Firefox extension)
# These should match your Plex server's accessible URLs
# Supports multiple patterns separated by comma
PLEX_WEB_URLS=http://192.168.xxx.xxx:32400/web,http://localhost:32400/web,http://127.0.0.1:32400/web

# =============================================================================
# Firefox Extension Configuration
# =============================================================================

# WebSocket URL for Firefox extension to connect to (inside Kasm container)
# Format: ws://host:port/browser
# Default: ws://localhost:10009/browser (localhost for in-container access)
FIREFOX_WS_URL=ws://localhost:10009/browser

# Alternative: Use container hostname or internal IP if connecting from outside
# FIREFOX_WS_URL=ws://kasmdiscordplexcontrol:10009/browser

# =============================================================================
# Container Configuration
# =============================================================================

# Container hostname (used for certificate CN and internal connections)
# Default: kasmdiscordplexcontrol
CONTAINER_HOSTNAME=kasmdiscordplexcontrol

# Container timezone
# Default: UTC
CONTAINER_TIMEZONE=UTC

# =============================================================================
# SSL/TLS Configuration
# =============================================================================

# Path to SSL certificate inside container
# Default: /home/kasm-user/.vnc/self.pem
SSL_CERT_PATH=/home/kasm-user/.vnc/self.pem

# Path to SSL key inside container
# Default: /home/kasm-user/.vnc/self.pem (same as cert for self-signed)
SSL_KEY_PATH=/home/kasm-user/.vnc/self.pem

# SSL certificate subject for self-signed generation
# Format: /C=US/ST=State/L=City/O=Org/OU=Unit/CN=hostname/emailAddress=email
SSL_CERT_SUBJECT=/C=US/ST=VA/L=None/O=None/OU=Plex/CN=kasmdiscordplexcontrol/emailAddress=none@none.none

# SSL certificate Subject Alternative Names (SANs)
# Comma-separated list of DNS names and IPs the certificate should be valid for
SSL_CERT_SANS=kasmdiscordplexcontrol,discord.xxx.com,localhost,127.0.0.1

# =============================================================================
# IPC Socket Configuration
# =============================================================================

# Path to IPC socket for inter-server communication
# Default: /tmp/plex-discord-ipc.sock
IPC_SOCKET_PATH=/tmp/plex-discord-ipc.sock

# =============================================================================
# Logging Configuration
# =============================================================================

# Log level: DEBUG, INFO, WARNING, ERROR
# Default: INFO
LOG_LEVEL=INFO

# WebSocket server log file
# Default: /tmp/websocket-wss.log
WS_LOG_FILE=/tmp/websocket-wss.log

# Browser server log file
# Default: /tmp/websocket-ws.log
WS_BROWSER_LOG_FILE=/tmp/websocket-ws.log

# Startup debug log file
# Default: /tmp/xstartup-debug.log
STARTUP_LOG_FILE=/tmp/xstartup-debug.log

# =============================================================================
# Feature Configuration
# =============================================================================

# Enable Discord Rich Presence
# Default: 1 (enabled)
ENABLE_DISCORD_RPC=1

# Enable WebSocket heartbeat
# Default: 1 (enabled)
ENABLE_HEARTBEAT=1

# Heartbeat interval in milliseconds
# Default: 30000 (30 seconds)
HEARTBEAT_INTERVAL=30000

# WebSocket command timeout in milliseconds
# Default: 2000 (2 seconds)
WS_COMMAND_TIMEOUT=2000

# Video seek duration for next/previous commands (fallback)
# Default: 30 (seconds)
VIDEO_SEEK_DURATION=30

# =============================================================================
# Advanced Configuration
# =============================================================================

# IPC relay mode
# Options: broadcast (default), direct
# broadcast: Relay messages to all connected clients
# direct: Route messages only to specific recipient
IPC_RELAY_MODE=broadcast

# WebSocket reconnection settings
MAX_RECONNECT_ATTEMPTS=5
RECONNECT_DELAY=3000

# Enable debug mode (verbose logging)
# Default: 0 (disabled)
DEBUG_MODE=0

# =============================================================================
# Notes
# =============================================================================

# 1. All environment variables are optional - system will use defaults
# 2. For local development, most defaults work without modification
# 3. For remote access, update:
#    - CONTAINER_HOST_IP: Your actual host IP
#    - EXTERNAL_DOMAIN: Your domain name or IP:port
#    - DISCORD_BOT_WS_URL: Must match your nginx setup
# 4. SSL configuration:
#    - Self-signed: SSL cert generated automatically with provided SUBJECT and SANS
#    - Custom cert: Provide paths to SSL_CERT_PATH and SSL_KEY_PATH
# 5. Plex URLs: Add all URLs your Plex server might be accessed from
# 6. When using docker-compose, reference this file with: env_file: .env

# =============================================================================